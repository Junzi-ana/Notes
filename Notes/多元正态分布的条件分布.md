---
{}
---
#SmallEssays/多元统计分析 

设 $X,~Y$ 服从二元正态分布 $N(\mu,\Sigma)$ ，如何计算 $Y|X$ 的分布？这个问题本身并不难，但我们希望通过揭露其内在结构，使得最终结果便于记忆一些。

为此，我们先考虑一个简单的情形
$$
\mu=\begin{bmatrix}
0\\0
\end{bmatrix},\quad \Sigma=\begin{bmatrix}
1& \rho\\
\rho&1
\end{bmatrix}
$$
从几何的角度，将中心化的正态变量视作一个 $L^{2}$ 空间中的元素，相关系数 $\rho$ 即为 $X,~Y$ 的夹角的余弦值。

因此，假定还有一个与 $X$ 相互正交的标准正态变量 $Z$，即 $\text{Cov}\,(X,Z)=0$，进而 $X,~Z$ 独立，那么 $Y$ 与 $Z$ 夹角就应是 $\sqrt{ 1-\rho^{2} }$ 。
于是 $Y$ 被 $X$ 和 $Z$ 线性表出，即有
$$
Y=\rho X+\sqrt{ 1+\rho^{2} }Z
$$
```tikz
\usepackage{tikz}
\begin{document}
\begin{tikzpicture}[font=\large, ]
\draw[->, line width=0.7pt] (0,0) node[below left] {$O$} -- (5,0) node[right] {$X$};
\draw[->, line width=0.7pt] (0,0) -- (0,5) node[left] {$Z$};
\draw[->, line width=0.7pt] (0,0) -- (2.5,4.33) node[above right] {$Y$};
\draw[dashed, line width=0.7pt] (2.5,4.33) -- (2.5,0) node[midway, right] {$\sqrt{1-\rho^2}$} node[below] {$\rho$};
\draw[line width=0.7pt] (5,0) arc (0:90:5);
\draw[->, line width=0.5pt] (0.5,0) arc (0:60:0.5);

\end{tikzpicture}
\end{document}
```

这个表达式的统计含义也是明显的，从线性回归的角度，将 $\sqrt{ 1+\rho^{2} }Z$ 视为是与自变量 $X$ 无关的噪音 $\varepsilon$，将 $Y$ 视作解释变量，则 $\rho$ 衡量了 $X$ 在多大程度上能解释 $Y$ 。

基于这个表达式，就能写出 $Y|X$ 的分布。将 $X$ 视为常数，$Y$ 服从均值为 $\rho X$，方差为 $1-\rho^{2}$ 的正态分布，即
$$
Y|X\sim N(\rho X,~ 1-\rho^{2})
$$

现在可以推广到一般的 $\mu,~\Sigma$ 的情形，此时只需作标准化，上式化为
$$
\frac{Y-\mu_{2}}{\sigma_{2}}=\rho\cdot\frac{X-\mu_{1}}{\sigma_{1}}\quad +\sqrt{ 1-\rho^{2} }Z
$$
化简得到
$$
\mu_{2|1}=\mu_{2}+\rho \frac{\sigma_{2}}{\sigma_{1}}(X-\mu_{1}),~ \quad \sigma^{2}_{2|1}=\sigma_{2}^{2}(1-\rho^{2})
$$
假如用协方差矩阵中的元素来表示，则可以写成
$$
\mu_{2|1}=\mu_{2}+ \frac{\sigma_{12}}{\sigma_{11}}(X-\mu_{1}),~ \quad \sigma^{2}_{2|1}=\sigma_{22}-\frac{\sigma_{12}^{2}}{\sigma_{11}}
$$
进而 $Y|X\sim N(\mu_{2|1},~\sigma_{2|1}^{2})$ 。

我们自然不止步于此，现在假设 $X=\begin{bmatrix}X_{1}\\X_{2}\end{bmatrix}$ 是随机向量，服从 $p$ 维正态分布 $N(\mu,\Sigma)$，其中 $X_{1},~X_{2}$ 分别是 $p_{1},~p_{2}$ 维向量
$$
\mu=\begin{bmatrix}
\mu_{1}\\ \mu_{2}
\end{bmatrix},\quad \Sigma=\begin{bmatrix}
\Sigma_{11}& \Sigma_{12}\\
\Sigma_{21}&\Sigma_{22}
\end{bmatrix}
$$
如何计算 $X_{2}|X_{1}$ 的分布呢？

我们希望作一个类似的分解。当 $\Sigma_{11},~\Sigma_{22}$ 都是单位阵且 $\mu=0$ 时，可以简单写出
$$
X_{2}=\Sigma_{21}X_{1}+\Sigma_{2|1}^{\frac{1}{2}}Z
$$
```tikz
\usepackage{tikz}
\begin{document}
\begin{tikzpicture}[font=\large, ]
\draw[->, line width=0.7pt] (0,0) node[below left] {$O$} -- (5,0) node[right] {$X_1$};
\draw[->, line width=0.7pt] (0,0) -- (0,5) node[left] {$Z$};
\draw[->, line width=0.7pt] (0,0) -- (2.5,4.33) node[above right] {$X_2$};
\draw[dashed, line width=0.7pt] (2.5,4.33) -- (2.5,0) node[midway, right] {$\Sigma_{2|1}^{1/2}$} node[below] {$\Sigma_{21}$};
\draw[line width=0.7pt] (5,0) arc (0:90:5);
\draw[->, line width=0.5pt] (0.5,0) arc (0:60:0.5);

\end{tikzpicture}
\end{document}
```

但由于在多元情形里表达方差和相关系数并不方便（否则就要用 $\Sigma_{11}^{-\frac{1}{2}}$ 和 $R=\Sigma_{11}^{-\frac{1}{2}}\Sigma_{12}\Sigma_{22}^{-\frac{1}{2}}$）所以直接用协方差矩阵中的元素来表示，即有 $Y|X\sim N(\mu_{2|1},~\Sigma_{2|1})$
$$
\mu_{2|1}=\mu_{2}+ \Sigma_{21}\Sigma_{11}^{-1}(X-\mu_{1}),\quad \Sigma_{2|1}=\Sigma_{22}-\Sigma_{21}\Sigma_{11}^{-1}\Sigma_{12}
$$

> [!remark]- 
> 此处与二元正态最大的区别在于，要区分 $\Sigma_{12}$ 和 $\Sigma_{21}$，相差一个转置，以及要区分矩阵的左乘右乘。当 $X_{2}$ 分解为 $X_{1}$ 和 $Z$ 时，下标的 $2$ 总是写在 $1$ 之前，反过来时所有的下标要对调。

---
*2025-11-11*
