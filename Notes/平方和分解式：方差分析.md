---
{}
---
#SmallEssays/多元统计分析 

让我们从一个比较简单的表达式开始
$$
\text{Var}\,X=\mathbb{E}X^{2}-(\mathbb{E}X)^{2}
$$
现在对总体 $X$ 进行抽样 $x_{1}, ~ x_{2}, \cdots,~ x_{n}$，假设总体均值为 $\mu$ ，记样本均值为 $\bar{x}$ ，则对上式进行相应替换得到
$$
\sum^{n}_{i=1}(x_{i}-\bar{x})^{2}=\sum^{n}_{i=1}x_{i}^{2}-n\bar{x}^{2} 
$$
再用 $x_{i}-\mu$ 替换 $x_{i}$，并移项得到
$$
\sum^{n}_{i=1} (x_{i}-\mu)^{2}=\sum^{n}_{i=1}(x_{i}-\bar{x})^{2}+n(\bar{x}-\mu)^{2} 
$$
这是统计中**平方和分解式**的最基础的形式。它虽然形式简单，但确有丰富的统计含义。

> [!note]- 
> 此处的 $\mu$ 也可以不是总体均值而是任一确定点，这个平方和分解式仍然成立

先看等式左侧，假如用 $x_{i}-\mu$ 表示样本对总体均值 $\mu$ 的偏离，为了消除符号的影响，平方后求和得到
$$
SST=\sum^{n}_{i=1} (x_{i}-\mu)^{2}
$$
称为**总平方和**，衡量数据相对于总体的变异程度。

至于等式右侧，记
$$
SSW=\sum^{n}_{i=1}(x_{i}-\bar{x})^{2} ,\quad SSB=\sum^{n}_{i=1}(\bar{x}-\mu)^{2}=n(\bar{x}-\mu)^{2} 
$$
分别为**离差平方和**和**偏差平方和**（借用了方差分析的记号）。前者与样本方差只相差一个常数倍，用于衡量数据内部的变异程度，而后者用于衡量样本均值相对于总体均值的偏离程度。

现在考虑一元方差分析问题。假定有 $K$ 个组，每个组分别自于总体 $X_{k}\sim N(\mu_{k},\sigma^{2})$，在每个总体中分别抽取 $n_{1}, \cdots,~ n_{K}$ 个样本 $x_{1}, \cdots,~ x_{1n_{1}},\cdots,~ x_{Kn_{K}}$ ，则该如何进行假设检验
$$
H_{0}:\mu_{1}=\cdots=\mu_{K}\quad \leftrightarrow \quad H_{1}: \exists\;i,j:~ \mu_{i}\neq \mu_{j}
$$

假设 $\bar{x}_{k}$ 为组 $k$ 的样本均值，而 $\bar{x}$ 表示全体样本的均值，用 $\bar{x}$ 替换 $\mu$ 并对所有组求和，即证明了如下恒等式
$$
\sum^{K}_{k=1}\sum^{n_{k}}_{i=1}(x_{ki}-\bar{x})^{2}=\sum^{K}_{k=1}\sum^{n_{k}}_{i=1}(x_{ki}-\bar{x}_{k})^{2}+  \sum^{K}_{k=1}n_{k}(\bar{x}_{k}-\bar{x})^{2}
$$
并将其仍简记为
$$
SST=SSW+SSB
$$
此处，$SST$ 称为**总平方和**，$SSW$ 称为**组内平方和**，$SSB$ 称为**组间平方和**。对正态总体而言，$SSB$ 与 $SSW$ 与相互独立，且分别服从自由度为 $k-1$ 和 $n-k$ 的 $\chi^{2}$ 分布（方差为 $\sigma^{2}$）。

当给定样本时，$SST$ 被确定，从直观上来说，当 $SSB$ 较大时，组间的变异程度大，说明每组之间存在差异，因此更倾向于拒绝原假设。于是定义检验统计量
$$
F=\frac{SSW / (n-k) }{ SSB / (k-1)}
$$
当 $H_{0}$ 为真时，$F\sim F_{n-k,k-1}$，因此称为 $F$ 检验。

更一般地，$F$ 检验可以由[[数理统计基本思想：似然函数、似然比|似然比检验]]导出。写出似然函数
$$
L=\prod^{K}_{k=1}\prod^{n_{k}}_{i=1} \frac{1}{\sqrt{ 2\pi }\sigma}\exp \left( -\frac{1}{2\sigma^{2}}(x_{ki}-\mu_{k})^{2} \right)   
$$
分别计算在参数空间 $\Theta$ 和 $\Theta_{0}$ 上的极大似然估计
$$
\begin{align}
&\hat{\mu}_{k}=\bar{x}_{k},&\hat{\sigma}=\frac{SSW}{n}\\
&\hat{\mu}_{k0}=\bar{x},&\hat{\sigma}_{0}=\frac{SST}{n}
\end{align}
$$
回代计算似然比
$$
\Lambda=\frac{\sup_{\Theta_{0}}L}{\sup_{\Theta }L}=\left( \frac{\hat{\sigma}^{2}}{\hat{\sigma}_{0}^{2}} \right)^{\frac{n}{2}} =\left( \frac{SSW}{SSW+SSB} \right) ^{\frac{n}{2}}
$$
由于 $SSW$ 和 $SSB$ 相互独立，经过一个单调变换即得到 $F$ 统计量。

倘若更进一步，所有样本都是 $p$ 维向量，$X_{p}\sim N(\mu_{k},\Sigma)$，考虑同样的多元方差分析问题，此时
$$
SSW=\sum^{K}_{k=1}\sum^{n_{k}}_{i=1}(x_{ik}-\bar{x}_{k})  (x_{ik}-\bar{x}_{k})  ^{T}
$$
称为**组内离差阵**，类似定义 $SST,~SSB$ 为**总离差阵**和**组间离差阵**。仍然有平方和分解式
$$
SST=SSW+SSB
$$
与一元方差分析类似，$SSB$ 与 $SSW$ 相互独立，且服从自由度 $k-1$ 和 $n-k$ 的 Wishart 分布 $W_{p}(k-1,\Sigma),~W_{p}(n-k,\Sigma)$ 。进而 $SST\sim W_{p}(n-1,\Sigma)$ 。

此时类似地计算似然比
$$
\Lambda=\left( \frac{|SSW|}{|SSW+SSB|} \right) ^{\frac{n}{2}}
$$
于是可以定义检验统计量 $\lambda$，在 $H_{0}$ 为真时服从参数为 $p,~n-k,~k-1$ 的 Wilks 分布
$$
\lambda=\frac{|SSW|}{|SSW+SSB|} \sim\Lambda_{p,n-k,k-1}
$$
当 $p=1,~2$ 或 $k=2,~3$ 时，Wilks 分布可转化为 $F$ 分布，除此之外 Wilks 分布的计算困难，然而当样本量较大时，可以使用 [[似然比检验的 Wilks 定理|Wilks 定理]] 。由于 $\mathrm{dim}\Theta=p\times k,~\mathrm{dim}\Theta_{0}=p\times1$，有
$$
-2\ln\Lambda=-n\ln\lambda \xrightarrow{d}\chi^{2}(p(k-1)) 
$$

---
*Reference: 多元统计分析, 何晓群*

---
*2025-11-9*