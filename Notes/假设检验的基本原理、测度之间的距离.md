---
{}
---
#SmallEssays/数理统计 

假设有简单随机样本 $X_{1}, ~ X_{2}, \cdots,~ X_{n}\in \mathcal{X}$ ，考虑非常一般的假设检验问题
$$
H_{0}:X\sim \mathbb{P}\leftrightarrow H_{1}:X\sim \mathbb{Q}
$$
此处，我们不确定显著性水平 $\alpha$，而是认为两个假设是**对等的**。此时我们的目的是构造一个检验统计量 $T$ 使得损失函数
$$
L(T)=\mathbb{P}^{\otimes n}(T=1)+\mathbb{Q}^{\otimes n}(T=0)
$$
最小化，即使得犯两类错误的概率之和最小化。

即便如此，[[假设检验：Neyman-Pearson 定理与 UMP|N-P 基本引理]]仍然暗示着我们采用似然比检验。似然比在本质上是用某种标度 $d$ （不一定是距离）来度量样本 $X^{n}=(X_{1}, ~ X_{2}, \cdots,~ X_{n})$ 与假设 $H_{0},~H_{1}$ 之间的远近程度。例如在[[非参数回归：经验似然方法]]中，似然比的对数实际是 KL 散度。然而此时，我们就引出了这两个问题：

> 1. 当样本量 $n\to \infty$ 时，是否存在这样一个标度 $d$ 使得 $d(\mathbb{P}^{\otimes n}\|\mathbb{Q}^{\otimes n})\not \to0$ ？
> 2. 当样本量 $n\to \infty$ 时，是否能够构造检验统计量 $T$ 使得 $L(T)\to0$ ？

第一个问题说的是测度序列 $\{ \mathbb{P}^{\otimes n} \}_{1}^{\infty}$ 和 $\{ \mathbb{Q}^{\otimes n} \}_{1}^{\infty}$ 之间的**临近性**，记为 $\mathbb{Q}^{\otimes n}\lhd\mathbb{P}^{\otimes n}$；第二个问题说的是它们之间的**完全渐近可区分性**，记为 $\mathbb{P}^{\otimes n}\triangle\mathbb{Q}^{\otimes n}$ 。这两个性质的严格数学定义较为繁琐，接下来只给出一些直觉上的理解，一些性质在用到时也会不加证明地给出。

关于第一个问题，在我们原本的设想中，我们希望通过比较经验分布 $\widehat{\mathbb{P}}$ 到两个假设的远近关系 $d(\mathbb{P}^{\otimes n}\| \widehat{\mathbb{P}} )$ 和 $d(\mathbb{Q}^{\otimes n}\| \widehat{\mathbb{P}} )$ 来进行检验，但假如当 $d(\mathbb{P}^{\otimes n}\|\mathbb{Q}^{\otimes n})$ 本身都趋于 $0$ 了，则不论经验分布如何，都无法区分二者，换言之，此时信息不够，假设检验没法做。特别要注意，当我们通过规定显著性水平来作假设检验时，$H_{0}$ 和 $H_{1}$ 是不对等的，因此 $d$ 也理所应当地没有对称性，正如 KL 散度一般，因此临近性本身并非一个对称的概念；而在本文中由于我们假设两个假设对等，所以我们会直接说两列测度是**相互临近的**，记作 $\mathbb{P}^{\otimes n}\lhd\rhd\mathbb{Q}^{\otimes n}$ 。至于第二个问题则相对好理解得多，我们希望一个类似于大数定律的东西，当样本量足够大时，我们有充分多的信息来保证我们作出的推断是万无一失的，此外，完全渐近可区分性是对称的。

> [!note]
> 当 $\mathbb{P}_{n}\equiv \mathbb{P},~\mathbb{Q}_{n}\equiv \mathbb{Q}$ 时，$\mathbb{Q}_{n}\lhd\mathbb{P}_{n}\iff \mathbb{Q}\ll \mathbb{P}$ 而 $\mathbb{P}_{n}\triangle\mathbb{Q}_{n}\iff \mathbb{P}\perp \mathbb{Q}$ 。因此临近性和完全渐近可区分性又被称为**渐近绝对连续性**和**渐近奇异性**。

假如我们能获得其极限分布，那么以上两个问题将不攻自破。然而，尽管 Wilks 定理可以推广到许多非常一般的情景，但在这样一个甚至没法对参数空间作任何假定的情景下，要计算渐近分布属实有些强人所难了，所以我们只得从问题本身入手。

假定 $\mu=\frac{\mathbb{P}+\mathbb{Q}}{2}$，则 $\mathbb{P}\ll \mu,~\mathbb{Q}\ll \mu$，为此记 $p,~q$ 为 $\mathbb{P},~\mathbb{Q}$ 对 $\mu$ 的 Radon-Nikodym 导数。现在计算
$$
\begin{align}
\mathcal{E}(\mathbb{P}^{\otimes n},\mathbb{Q}^{\otimes n})&=\inf_{T} \left( \mathbb{P}^{\otimes n}(T=1)+\mathbb{Q}^{\otimes n}(T=0) \right) \\
&=1+\inf_{T}\int_{\{ T=1 \}}(\mathrm{d}\mathbb{P}^{\otimes n}-\mathrm{d} \mathbb{Q}^{\otimes n}) \\
&=1-\left\| \mathbb{P}^{\otimes n}-\mathbb{Q}^{\otimes n} \right\|_{TV} 
\end{align}
$$
其中 $\|\cdot\|_{TV}$ 表示测度的全变差范数，作用相当于前文中的 $d(\cdot\|\cdot)$。由 Hahn 分解知当 $\{ T=1 \}$ 取作符号测度 $\mathbb{P}-\mathbb{Q}$ 的负支撑时达到下确界。此处，$\mathcal{E}(\mathbb{P},\mathbb{Q})$ 所表征的就是假设 $H_{0},~H_{1}$ 的区分程度，表示依照当前的样本信息，我们可以在多大程度上通过假设检验来区分 $\mathbb{P}$ 和 $\mathbb{Q}$ ，当 $L(T)\to0$ 时，$\mathcal{E}\to1$，表示随着样本量的增大，最终两个假设被完全分离，反之则无法完全分离。

然而，计算全变差范数
$$
\left\| \mathbb{P}^{\otimes n}-\mathbb{Q}^{\otimes n} \right\|_{TV} =\int_{\mathcal{X}^{n}} \prod^{n}_{i=1}p(x_{i})\wedge \prod^{n}_{i=1}q(x_{i})   \; \mu(\mathrm{d}x_{1}) \cdots\mu(\mathrm{d} x_{n})
$$
光从表达式上就可以看出，是非常复杂的事情，不过由于我们只研究 $n\to \infty$ 时的情景，也无需强行计算，可以寻找其替代品。这个替代品应该也起到表征测度之间远近关系的作用，并且应该能涵盖全变差距离和 KL 散度。

于是在这里引入一个非常重要的概念：$f$ 散度
$$
D_{f}(P\|Q)=\mathbb{E}_{\mathbb{Q}}f\left( \frac{\mathrm{d} \mathbb{P}}{\mathrm{d} \mathbb{Q}} \right) =\int_{\mathcal{X}} f\big(\frac{p}{q}\big) \; \mu(\mathrm{d}x) 
$$
其中，$f(x)=x\ln x$ 时为 KL 散度，$f(x)=\frac{1}{2}|1-x|$ 时为全变差距离。当然这个概念在本文中本身不是特别重要，重要的是取 $f(x)=(1-\sqrt{ x })^{2}$ 的情形，此时记
$$
\rho^{2}(\mathbb{P},\mathbb{Q})=\frac{1}{2}\int_{\mathcal{X}}  \; (\sqrt{ \mathrm{d} \mathbb{P} }-\sqrt{ \mathrm{d} \mathbb{Q} })^{2}=1-\int_{\mathcal{X}} \sqrt{ \mathrm{d} \mathbb{P}\mathrm{d} \mathbb{Q} }=1-H(\mathbb{P},\mathbb{Q})
$$
则 $\rho$ 称为 **Kakutani-Hellinger 距离**（以下简称 Hellinger 距离），$H$ 为 $\frac{1}{2}$ 阶 Hellinger 积分。

它有两条非常重要的性质，使得我们可以用 Hellinger 距离来代替全变差距离。
1. $H(\mathbb{P}_{n},\mathbb{Q}_{n})=H^{n}(\mathbb{P},\mathbb{Q})$
2. $2\rho^{2}(\mathbb{P},\mathbb{Q})\leq\|\mathbb{P}-\mathbb{Q}\|_{TV}\leq \sqrt{ 8 }\rho(\mathbb{P},\mathbb{Q})$
其证明基于直接计算，此处略去。

借此，记 $\lambda=-\ln H(\mathbb{P},\mathbb{Q})\geq \rho^{2}(\mathbb{P},\mathbb{Q})$，其地位相当于对数似然比，能够得到估计
$$
\frac{1}{2}e^{-2\lambda n}\leq \mathcal{E}(\mathbb{P}^{\otimes n},\mathbb{Q}^{\otimes n})\leq e^{-\lambda n}
$$
于是我们可以作出结论，当 $H(\mathbb{P},\mathbb{Q})<1$ 时，$\mathbb{P}^{\otimes n}\triangle\mathbb{Q}^{\otimes n}$，且随着样本量的增加，最小损失 $\mathcal{E}$ 以指数速度趋于 $0$ 。

当然如果就这样结束了，似乎显得有点杀鸡用牛刀了，这个结论可以简单推广到**每个样本独立但不同分布**的情形，即有如下定理成立。

**定理** $\{ \mathbb{P}_{n} \}_{1}^{\infty},~\{ \mathbb{Q}_{n} \}_{1}^{\infty}$ 是两列概率测度列，则
$$
\left\| \overset{n}{\underset{i=1 }{{\huge \otimes} }} \mathbb{P}_{i} -\overset{n}{\underset{i=1 }{{\huge \otimes} }} \mathbb{Q}_{i}\right\|_{TV} \to0\iff H^{2}(\overset{n}{\underset{i=1 }{{\huge \otimes} }} \mathbb{P}_{i}\, ,\overset{n}{\underset{i=1 }{{\huge \otimes} }} \mathbb{Q}_{i})=o(\frac{1}{n})\iff \mathbb{P}_{n}\lhd\rhd\mathbb{Q}_{n}
$$
$$
\left\| \overset{n}{\underset{i=1 }{{\huge \otimes} }} \mathbb{P}_{i} -\overset{n}{\underset{i=1 }{{\huge \otimes} }} \mathbb{Q}_{i}\right\|_{TV} \to1\iff H^{2}(\overset{n}{\underset{i=1 }{{\huge \otimes} }} \mathbb{P}_{i}\, ,\overset{n}{\underset{i=1 }{{\huge \otimes} }} \mathbb{Q}_{i})=\omega(\frac{1}{n})\iff \mathbb{P}_{n}\triangle\mathbb{Q}_{n}
$$

---
*References:*
1. *概率（第一卷）, A. H. 施利亚耶夫*
2. [[lecture2 (1).pdf]]

---
*2025-10-25*